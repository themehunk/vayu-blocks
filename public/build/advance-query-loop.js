(()=>{"use strict";var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,o=window.wp.i18n,r=window.React;var l=e.n(r),n={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=l().createContext&&l().createContext(n),s=function(){return s=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var l in t=arguments[o])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e},s.apply(this,arguments)},c=function(e,t){var o={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(r=Object.getOwnPropertySymbols(e);l<r.length;l++)t.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(e,r[l])&&(o[r[l]]=e[r[l]])}return o};function i(e){return e&&e.map((function(e,t){return l().createElement(e.tag,s({key:t},e.attr),i(e.child))}))}function u(e){return function(t){return l().createElement(d,s({attr:s({},e.attr)},t),i(e.child))}}function d(e){var t=function(t){var o,r=e.attr,n=e.size,a=e.title,i=c(e,["attr","size","title"]),u=n||t.size||"1em";return t.className&&(o=t.className),e.className&&(o=(o?o+" ":"")+e.className),l().createElement("svg",s({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,i,{className:o,style:s(s({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),a&&l().createElement("title",null,a),e.children)};return void 0!==a?l().createElement(a.Consumer,null,(function(e){return t(e)})):t(n)}function p(e){return u({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M3.35355 1.85355C3.54882 1.65829 3.54882 1.34171 3.35355 1.14645C3.15829 0.951184 2.84171 0.951184 2.64645 1.14645L0.646447 3.14645C0.451184 3.34171 0.451184 3.65829 0.646447 3.85355L2.64645 5.85355C2.84171 6.04882 3.15829 6.04882 3.35355 5.85355C3.54882 5.65829 3.54882 5.34171 3.35355 5.14645L2.20711 4H9.5C11.433 4 13 5.567 13 7.5C13 7.77614 13.2239 8 13.5 8C13.7761 8 14 7.77614 14 7.5C14 5.01472 11.9853 3 9.5 3H2.20711L3.35355 1.85355ZM2 7.5C2 7.22386 1.77614 7 1.5 7C1.22386 7 1 7.22386 1 7.5C1 9.98528 3.01472 12 5.5 12H12.7929L11.6464 13.1464C11.4512 13.3417 11.4512 13.6583 11.6464 13.8536C11.8417 14.0488 12.1583 14.0488 12.3536 13.8536L14.3536 11.8536C14.5488 11.6583 14.5488 11.3417 14.3536 11.1464L12.3536 9.14645C12.1583 8.95118 11.8417 8.95118 11.6464 9.14645C11.4512 9.34171 11.4512 9.65829 11.6464 9.85355L12.7929 11H5.5C3.567 11 2 9.433 2 7.5Z",fill:"currentColor"}}]})(e)}const y=window.wp.hooks,v=window.wp.blockEditor,b=window.wp.components,w=window.wp.data,h=window.wp.element,k=window.ReactJSXRuntime,m=[{label:(0,o.__)("Newest to oldest","vayu-blocks"),value:"date/desc"},{label:(0,o.__)("Oldest to newest","vayu-blocks"),value:"date/asc"},{label:(0,o.__)("A → Z","vayu-blocks"),value:"title/asc"},{label:(0,o.__)("Z → A","vayu-blocks"),value:"title/desc"}],g=({order:e,orderBy:t,onChange:r})=>(0,k.jsx)(b.SelectControl,{label:(0,o.__)("Order by","vayu-blocks"),value:`${t}/${e}`,options:m,onChange:e=>{const[t,o]=e.split("/");r({order:o,orderBy:t})}}),_=window.wp.coreData;window.wp.htmlEntities,(0,y.addFilter)("editor.BlockEdit","vayu-blocks/with-filtered-controls",(e=>r=>{const{attributes:l,setAttributes:n,clientId:a}=r,{query:s={}}=l,{inherit:c=!1,sticky:i=!1,postType:u="post",exclude:d=[]}=s,{order:p="desc",orderBy:y="date"}=s,{postTypesSelectOptions:m}=(()=>{const e=(0,w.useSelect)((e=>{const{getPostTypes:t}=e(_.store),o=["attachment"],r=t({per_page:-1})?.filter((({viewable:e,slug:t})=>e&&!o.includes(t)));return r}),[]);return{postTypesTaxonomiesMap:(0,h.useMemo)((()=>{if(e?.length)return e.reduce(((e,t)=>(e[t.slug]=t.taxonomies,e)),{})}),[e]),postTypesSelectOptions:(0,h.useMemo)((()=>(e||[]).map((({labels:e,slug:t})=>({label:e.singular_name,value:t})))),[e])}})(),[C,f]=(0,h.useState)(""),[x,j]=(0,h.useState)([]),{replaceInnerBlocks:B}=(0,w.useDispatch)("core/block-editor"),S=(0,w.useSelect)((e=>{const{getEntityRecords:t}=e("core");return t("postType",u,{search:C,per_page:10})}),[C,u]);(0,h.useEffect)((()=>{S&&j(S)}),[S]);const O=(0,w.useSelect)((e=>!!e("core/block-editor").getBlocks(a).length),[a]);return"vayu-blocks/advance-query-loop"===l.namespace?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(e,{...r}),(0,k.jsx)(v.InspectorControls,{children:(0,k.jsxs)(b.PanelBody,{title:(0,o.__)("Advanced Query Settings","vayu-blocks"),children:[(0,k.jsx)(b.ToggleControl,{label:(0,o.__)("Inherit Query From Parent","vayu-blocks"),checked:c,onChange:e=>{n({query:{...s,inherit:e}})}}),(0,k.jsx)(b.ToggleControl,{label:(0,o.__)("Show Sticky Posts","vayu-blocks"),checked:i,onChange:e=>{n({query:{...s,sticky:e}})}}),(0,k.jsx)(g,{order:p,orderBy:y,onChange:e=>{n({query:{...s,...e}})}}),(0,k.jsx)(b.SelectControl,{label:(0,o.__)("Post Type","vayu-blocks"),value:u,options:m,onChange:e=>{n({query:{...s,postType:e}})}}),(0,k.jsx)(b.BaseControl,{label:(0,o.__)("Exclude Posts","vayu-blocks"),help:(0,o.__)("Start typing to search for a post title or manually enter one.","vayu-blocks"),children:(0,k.jsx)(b.FormTokenField,{value:d&&d.length>0?d.map((e=>{const t=x.find((t=>t.id===e));return t?t.title.rendered:""})):[],suggestions:x&&x.length>0?x.map((e=>e.title.rendered)):[],onInputChange:e=>f(e),onChange:e=>{const t=e.map((e=>{const t=x.find((t=>t.title.rendered===e));return t?t.id:null})).filter(Boolean);n({query:{...s,exclude:[...new Set(t)]}}),f("")},__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1})})]})}),!O&&(0,k.jsx)(b.Placeholder,{label:(0,o.__)("Advance Query Block","vayu-blocks"),instructions:(0,o.__)("Select a variation to start with:","vayu-blocks"),children:(0,k.jsx)(v.__experimentalBlockVariationPicker,{icon:"layout",label:"Choose a layout",variations:[{name:"layout-one",title:"Layout one",icon:"columns",innerBlocks:[["vayu-blocks/wrapper"],["core/query-pagination"],["core/query-no-results"]],scope:["block"],isDefault:!0},{name:"layout-two",title:"Layout Two",icon:"columns",innerBlocks:[["vayu-blocks/wrapper"],["core/query-pagination"],["core/query-no-results"]],scope:["block"],isDefault:!0}],onSelect:e=>{e.innerBlocks&&B(a,(0,t.createBlocksFromInnerBlocksTemplate)(e.innerBlocks),!1)}})})]}):(0,k.jsx)(e,{...r})})),(0,t.registerBlockVariation)("core/query",{name:"vayu-blocks/advance-query-loop",title:(0,o.__)("Advance Query Block","vayu-blocks"),description:(0,o.__)("A custom block extending the core Query Loop block with dynamic post templates.","vayu-blocks"),icon:(0,k.jsx)(p,{style:{color:"#6c1bc3",fontSize:"12px"}}),category:"vayu-blocks",attributes:{namespace:"vayu-blocks/advance-query-loop"},isActive:e=>"vayu-blocks/advance-query-loop"===e.namespace,allowedControls:["taxQuery","author","search","exclude"]})})();